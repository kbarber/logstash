input {
  stdin {
    type => "syslog"
  }
}

filter {
  grok {
    type => "syslog"
    pattern => "%{SYSLOGLINE}"
  }

  date {
    type => "syslog"
    timestamp => "MMM  d HH:mm:ss"
    timestamp => "MMM dd HH:mm:ss"
    timestamp8601 => ISO8601
  }

  esper {
    type => "syslog"
#    expression => "select * from event"
    expression => "select * from event.win:time_batch(5 sec)"
#    expression => "select `@fields`.`MONTH`? as foo from event"
#    expression => "select *, `@fields` as `@foo` from event"
#    expression => "select `@fields` as `@foo` from event"
#    expression => "select `@source`,`@type`,`@message` as `@source_host` from event"
#    expression => "select distinct `@message` from event.win:time(30 sec)"
    add_tag => "esper_match"
  }
}

output {
  stdout { 
    tags => "esper_match"
    debug => true
  }
}
